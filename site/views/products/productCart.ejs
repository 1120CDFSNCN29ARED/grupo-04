<!DOCTYPE html>
<html lang="es">

<head>
    <%- include('../partials/head')%>
        <link rel="stylesheet" href="/css/styles-form.css">
        <link rel="stylesheet" href="/css/productCart.css">
</head>

<body>

    <%- include('../partials/header')%>

        <main>
            <section>
                <h2>Carrito de Compras: </h2>
                <div class="cart">
                    <div class="product-list">
                        <% if (cart) { %>
                            <% for( let i=0; i < cart.length; i++ ) { %>
                                <article class="product">
                                    <a href="/products/detail/<%= cart[i].producto.id %> "><img
                                            src="/img/products/<%=cart[i].producto.imagenes[0].imagen%>"
                                            alt="imagen producto" class="product-image"></a>
                                    <h3 class="product-name">
                                        <%=cart[i].producto.nombre%>
                                    </h3>
                                    <h3 class="product-cost">
                                        <%=(Number(cart[i].producto.precio * cart[i].cantidad)).toLocaleString('es-AR',
                                            {minimumFractionDigits: 2, maximumFractionDigits: 2, style: 'currency' ,
                                            currency: 'ARS' })%>
                                    </h3>
                                    <p class="product-descript">

                                    </p>
                                    <form
                                        action="/products/cart/edit/<%=cart[i].id%>/<%=cart[i].producto_id%>?_method=put"
                                        method="post">
                                        <select class="product-quantity" name="productquantity" id="product-quantity">
                                            <% for( let j=0; j < (cart[i].producto.cantidad_real -
                                                cart[i].producto.cantidad_en_pedido + cart[i].cantidad); j++ ) { %>
                                                <option value="<%= j +1 %>" class="product-quantity-value"
                                                    <%=cart[i].cantidad==j + 1 ? 'selected' : "" %> ><%= j +1 %>
                                                </option>
                                                <% } %>
                                        </select>
                                        <button type="submit" class="product-edit">Editar</button>
                                    </form>
                                    <form
                                        action="/products/cart/delete/<%=cart[i].id%>/<%=cart[i].producto_id%>?_method=delete"
                                        method="post">
                                        <button type="submit" class="product-del">Eliminar</button>
                                    </form>
                                </article>
                                <% } %>
                                    <% } else { %>
                                        <div class="emptyCart">
                                            <p>TU CARRITO ESTA VACIO</p>
                                        </div>
                                        <% } %>
                    </div>
                </div>
                <% if (account) {%>
                    <div class="product-price">
                        <h3 class="product-price-cost">
                            <%=(Number(account.total())).toLocaleString('es-AR', {minimumFractionDigits: 2,
                                maximumFractionDigits: 2, style: 'currency' , currency: 'ARS' })%>
                        </h3>
                        <div class="product-detail-cost">
                            <h4 class="product-subTotal">Subtotal
                                <%=(Number(account.total() - account.impuestos())).toLocaleString('es-AR',
                                    {minimumFractionDigits: 2, maximumFractionDigits: 2, style: 'currency' ,
                                    currency: 'ARS' })%>
                            </h4>
                            <h4 class="product-tax">Impuestos <%=(Number(account.impuestos())).toLocaleString('es-AR',
                                    {minimumFractionDigits: 2, maximumFractionDigits: 2, style: 'currency' ,
                                    currency: 'ARS' })%>
                            </h4>
                            <h4 class="product-shipping">Envio</h4>
                        </div>
                        <div class="product-cost-total">
                            <h4 class="product-discount">Descuentos</h4>
                            <h4 class="product-total">
                                <%=(Number(account.total())).toLocaleString('es-AR', {minimumFractionDigits: 2,
                                    maximumFractionDigits: 2, style: 'currency' , currency: 'ARS' })%>
                            </h4>
                        </div>
                        <form action="/products/cart/buy" method="post"><button type="submit"
                                class="product-buy">Comprar</button></form>
                    </div>
                    <% } %>
                        </div>
            </section>
        </main>

        <%- include('../partials/footer')%>

</body>

</html>